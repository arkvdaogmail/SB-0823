<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Supabase File Management</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <div id="errorContainer" style="color: red;"></div>

    <script>
        function logError(message, error) {
            console.error(message, error);
            const errorContainer = document.getElementById('errorContainer');
            if (errorContainer) {
                errorContainer.innerHTML += `<p>${message}: ${error || 'Unknown error'}</p>`;
            }
        }

        try {
            const SUPABASE_URL = 'https://mfrefbmnxygeahaluhzr.supabase.co';
            const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1mcmVmYm1ueHlnZWFoYWx1aHpyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI1NDIxOTUsImV4cCI6MjA2ODExODE5NX0.Ur3hl7rVEWk6U-ydNbKymFmXtxUlx6RTn0pU0EnP7u0';
            
            const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

            async function checkAuthStatus() {
                try {
                    const { data, error } = await supabaseClient.auth.getSession();
                    
                    if (error) throw error;
                    
                    return data.session ? true : false;
                } catch (authError) {
                    logError('Authentication Error', authError);
                    return false;
                }
            }

            async function initializeApp() {
                const isAuthenticated = await checkAuthStatus();
                
                if (!isAuthenticated) {
                    try {
                        await supabaseClient.auth.signInWithOAuth({
                            provider: 'github',
                            options: { redirectTo: window.location.href }
                        });
                    } catch (oauthError) {
                        logError('OAuth Error', oauthError);
                    }
                }
            }

            document.addEventListener('DOMContentLoaded', initializeApp);

        } catch (globalError) {
            logError('Global Initialization Error', globalError);
        }
    </script>
</body>
</html>
